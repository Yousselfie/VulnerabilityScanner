import requests

security_headers = ["X-Frame-Option",

"X-XSS-Protection",

"X-Content-Type-Options",

"Referrer-Policy",

"Strict-Transport-Security",

"Content-Security-Policy",

"Permissions-Policy"]

def get_headers(domain):
    return requests.get(domain).headers

def check_vulnerabilities(domain):
    counter = 0
    result = ""

    for security_header in security_headers:
        if not (security_header in get_headers(domain)):
            counter+=1
            result += (f"{security_header} is missing\n")
    result += (f"\nScan complete\n\n{counter} vulnerabilities were found on this site.")
    return result

